"use strict";const X=require("@codemirror/state"),t=require("@lezer/highlight"),f=require("markedit-api"),_=require("@codemirror/view"),y=require("@codemirror/language"),x=(a,s={})=>a??s,Y=x(f.MarkEdit.userSettings),E=I("extension.markeditTheming"),Z=v(!1)?x(E.lightTheme):void 0,tt=v(!0)?x(E.darkTheme):void 0;function I(a){return a===void 0?{}:x(Y[a])}function j(a){return a.enabledMode??"both"}function v(a,s=j(E)){return["both",a?"dark":"light"].includes(s)}function et(a,s,e){const c=ot({lhs:e,rhs:a?tt:Z});return{extensions:[...a?P(c,{dark:!0}):P(c),s].filter(o=>o!==void 0),colors:c}}function P(a,s){const e={},c=[],r=a.editor,o=a.highlight;r?.textColor&&(e["&"]??={},e["&"].color=r?.textColor,e[".cm-activeLineGutter"]={backgroundColor:r?.textColor}),r?.backgroundColor&&(e["&"]??={},e["&"].backgroundColor=r?.backgroundColor),r?.activeLineBackground&&(e[".cm-activeLine"]={backgroundColor:r?.activeLineBackground}),r?.caretColor&&(e[".cm-content"]={caretColor:r?.caretColor},e[".cm-cursor, .cm-dropCursor"]={borderLeftColor:r?.caretColor}),r?.selectionBackground&&(e["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:r?.selectionBackground}),r?.matchingBracketBackground&&(e["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:r?.matchingBracketBackground}),r?.gutterText&&(e[".cm-gutters"]??={},e[".cm-gutters"].color=r?.gutterText),r?.gutterBackground&&(e[".cm-gutters"]??={},e[".cm-gutters"].backgroundColor=r?.gutterBackground,e[".cm-gutters"].border="none"),r?.foldPlaceholderText&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].color=r?.foldPlaceholderText),r?.foldPlaceholderBackground&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].backgroundColor=r?.foldPlaceholderBackground,e[".cm-foldPlaceholder"].border="none"),r?.searchMatchBackground&&(e[".cm-searchMatch"]={backgroundColor:r?.searchMatchBackground}),r?.selectionMatchBackground&&(e[".cm-selectionMatch"]={backgroundColor:r?.selectionMatchBackground}),o?.heading&&c.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&c.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&c.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&c.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&c.push({tag:t.tags.quote,color:o?.quote}),o?.link&&c.push({tag:[t.tags.url,t.tags.link],color:o?.link}),o?.divider&&c.push({tag:t.tags.contentSeparator,color:o?.divider}),o?.comment&&c.push({tag:t.tags.comment,color:o?.comment}),o?.meta&&c.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&c.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&c.push({tag:[t.tags.atom,t.tags.bool],color:o?.atom}),o?.literal&&c.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&c.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&c.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&c.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&c.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&c.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&c.push({tag:t.tags.className,color:o?.class}),o?.macro&&c.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&c.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&c.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&c.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&c.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&c.push({tag:[t.tags.separator,t.tags.processingInstruction,t.tags.definition(t.tags.name)],color:o?.instruction}),o?.invalid&&c.push({tag:t.tags.invalid,color:o?.invalid});const i=[];return Object.keys(e).length>0&&i.push(_.EditorView.theme(e,s)),c.length>0&&i.push(y.syntaxHighlighting(y.HighlightStyle.define(c))),i}function ot(a){return{editor:{...a.lhs?.editor,...a.rhs?.editor},highlight:{...a.lhs?.highlight,...a.rhs?.highlight},subtleEmphasis:a.rhs?.subtleEmphasis??a.lhs?.subtleEmphasis}}const n={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark, .cm-md-bold.tok-meta, .cm-md-italic.tok-meta, .cm-md-strikethrough.tok-meta",boldText:".cm-md-bold:not(.tok-meta)",italicText:".cm-md-italic:not(.tok-meta)",quoteText:".cm-md-quote:not(.cm-md-quoteMark)",dividerColor:".cm-md-horizontalRule"},rt=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${n.lineGutter} {}
${n.foldGutter} {}
${n.visibleSpace} {}
${n.matchingBracket} {}
${n.activeIndicator} {}
${n.accentColor} {}
${n.syntaxMarker} {}
${n.boldText} {}
${n.italicText} {}
${n.quoteText} {}
${n.dividerColor} {}
`,G=window,at=G.__extractStyleRules__??(a=>a.value?.rules),ct=G.__extractHighlightSpecs__??(a=>a.value?.specs);function st(a){const s=document.createElement("style");return s.textContent=a,document.head.appendChild(s),s}function nt(a){if(a.length===0)return[{},[]];const s=N(a);return[Object.fromEntries(s.flatMap(c=>{const r=at(c)?.join(`
`)??"";return Object.entries(lt(r))})),s.flatMap(c=>ct(c)??[])]}function h(a,s,e){return a.find(c=>!!(c.tag.toString().includes(s.toString())&&c.color!==void 0))?.color??e}function M(a,s,e){for(const[c,r]of Object.entries(a))if(c.includes(s)&&(e===void 0||!c.includes(e))){const o=r.background??r.backgroundColor;if(o!==void 0)return o}}function it(a){const s=a.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(s===null)return;const[e,c,r]=s.slice(1,4).map(Number);return`rgba(${e}, ${c}, ${r}, 0.6)`}function H(a){const s=r=>r!==null&&typeof r=="object";if(!s(a))return!0;const e=Object.entries(a),c=r=>r!=null;for(const[,r]of e)if(s(r)){if(!H(r))return!1}else if(c(r))return!1;return!0}function N(a){return Array.isArray(a)?a.flatMap(N):"extension"in a?N(a.extension):[a]}function lt(a){const s={},e=new CSSStyleSheet;e.replaceSync(a);for(const c of e.cssRules){const{style:r,selectorText:o}=c,{background:i,backgroundColor:g}=r;s[o]={},i.length>0&&(s[o].background=i),g.length>0&&(s[o].backgroundColor=g)}return s}function gt(a){const s=a.options?.settingsKey,e=j(I(s));a.light!==void 0&&v(!1,e)&&(l().customThemes.light=a.light),a.dark!==void 0&&v(!0,e)&&(l().customThemes.dark=a.dark),typeof f.MarkEdit.editorView=="object"&&w(f.MarkEdit.editorView)}const b=window,l=()=>b.__markeditTheming__,R=matchMedia("(prefers-color-scheme: dark)");typeof l()!="object"&&dt();function dt(){b.__markeditTheming__={styleSheet:st(rt),configurator:new X.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},f.MarkEdit.addExtension(l().configurator.of([])),f.MarkEdit.onEditorReady(s=>w(s));const a=()=>setTimeout(()=>w(f.MarkEdit.editorView),15);R.addEventListener("change",a),l().mainThemeName=b.config.theme,Object.defineProperty(b.config,"theme",{get(){return l().mainThemeName},set(s){l().mainThemeName=s,a()}})}function w(a){const s=R.matches,e=s?l().customThemes.dark:l().customThemes.light,{extensions:c,colors:r}=et(s,e?.extension,e?.colors);a.dispatch({effects:l().configurator.reconfigure(c)});const[o,i]=nt(c),g=c.length===0&&H(r);l().styleSheet.disabled=g,ut(a,s,g,o,i,r)}function ut(a,s,e,c,r,o){const i=M(c,".cm-activeLine",".cm-activeLineGutter"),g=M(c,n.selectionBackground),T=M(c,n.matchingBracket),k=getComputedStyle(a.contentDOM).color,q=o.editor?.visibleSpaceColor??it(k),m=o.subtleEmphasis===!0?k:void 0,$=h(r,t.tags.heading,m),D=h(r,t.tags.processingInstruction,m),V=h(r,t.tags.strong,m),A=h(r,t.tags.emphasis,m),K=h(r,t.tags.quote,m),z=h(r,t.tags.contentSeparator,m),W=[[n.activeIndicator,i,"background"],[n.matchingBracket,T,"background"],[n.lineGutter,k,"color"],[n.foldGutter,q,"color"],[n.visibleSpace,q,"color"],[n.accentColor,$,"color"],[n.syntaxMarker,D,"color"],[n.boldText,V,"color"],[n.italicText,A,"color"],[n.quoteText,K,"color"],[n.dividerColor,z,"color"]],U=Array.from(document.querySelectorAll("style")),p=s?l().darkOriginalRules:l().lightOriginalRules;for(const J of U){const B=J.sheet?.cssRules;if(B!==void 0)for(let S=0;S<B.length;++S){const d=B[S],u=d.selectorText??"";u.includes(".cm-focused")&&u.includes(n.selectionBackground)&&(p.selectionBackground??=d.cssText,e?d.cssText=p.selectionBackground:g!==void 0&&d.style.setProperty("background",g,"important")),$!==void 0&&(u===".cm-md-header"||u===".cm-md-header:not(.cm-md-quote)")&&(p.markdownHeader??=d.cssText,e?d.cssText=p.markdownHeader:d.style.removeProperty("color"));for(const[Q,L,O]of W)u===Q&&(L===void 0?d.style.removeProperty(O):(d.style.setProperty(O,L,"important"),(u===n.matchingBracket||u===n.activeIndicator)&&d.style.setProperty("box-shadow","unset","important")))}}}function C(){return C=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var e=arguments[s];for(var c in e)({}).hasOwnProperty.call(e,c)&&(a[c]=e[c])}return a},C.apply(null,arguments)}var F=a=>{var{theme:s,settings:e={},styles:c=[]}=a,r={".cm-gutters":{}},o={};e.background&&(o.backgroundColor=e.background),e.backgroundImage&&(o.backgroundImage=e.backgroundImage),e.foreground&&(o.color=e.foreground),e.fontSize&&(o.fontSize=e.fontSize),(e.background||e.foreground)&&(r["&"]=o),e.fontFamily&&(r["&.cm-editor .cm-scroller"]={fontFamily:e.fontFamily}),e.gutterBackground&&(r[".cm-gutters"].backgroundColor=e.gutterBackground),e.gutterForeground&&(r[".cm-gutters"].color=e.gutterForeground),e.gutterBorder&&(r[".cm-gutters"].borderRightColor=e.gutterBorder),e.caret&&(r[".cm-content"]={caretColor:e.caret},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:e.caret});var i={};e.gutterActiveForeground&&(i.color=e.gutterActiveForeground),e.lineHighlight&&(r[".cm-activeLine"]={backgroundColor:e.lineHighlight},i.backgroundColor=e.lineHighlight),r[".cm-activeLineGutter"]=i,e.selection&&(r["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:e.selection+" !important"}),e.selectionMatch&&(r["& .cm-selectionMatch"]={backgroundColor:e.selectionMatch});var g=_.EditorView.theme(r,{dark:s==="dark"}),T=y.HighlightStyle.define(c),k=[g,y.syntaxHighlighting(T)];return k},mt={background:"#1a1b26",foreground:"#787c99",caret:"#c0caf5",selection:"#515c7e40",selectionMatch:"#16161e",gutterBackground:"#1a1b26",gutterForeground:"#787c99",gutterBorder:"transparent",lineHighlight:"#474b6611"},ht=[{tag:t.tags.keyword,color:"#bb9af7"},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.macroName],color:"#c0caf5"},{tag:[t.tags.propertyName],color:"#7aa2f7"},{tag:[t.tags.processingInstruction,t.tags.string,t.tags.inserted,t.tags.special(t.tags.string)],color:"#9ece6a"},{tag:[t.tags.function(t.tags.variableName),t.tags.labelName],color:"#7aa2f7"},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:"#bb9af7"},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:"#c0caf5"},{tag:[t.tags.className],color:"#c0caf5"},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:"#ff9e64"},{tag:[t.tags.typeName],color:"#0db9d7"},{tag:[t.tags.operator,t.tags.operatorKeyword],color:"#bb9af7"},{tag:[t.tags.url,t.tags.escape,t.tags.regexp,t.tags.link],color:"#b4f9f8"},{tag:[t.tags.meta,t.tags.comment],color:"#444b6a"},{tag:t.tags.strong,fontWeight:"bold"},{tag:t.tags.emphasis,fontStyle:"italic"},{tag:t.tags.link,textDecoration:"underline"},{tag:t.tags.heading,fontWeight:"bold",color:"#89ddff"},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:"#c0caf5"},{tag:t.tags.invalid,color:"#ff5370"},{tag:t.tags.strikethrough,textDecoration:"line-through"}],ft=a=>{var{theme:s="dark",settings:e={},styles:c=[]}={};return F({theme:s,settings:C({},mt,e),styles:[...ht,...c]})},kt=ft(),pt={background:"#e1e2e7",foreground:"#3760bf",caret:"#3760bf",selection:"#99a7df",selectionMatch:"#99a7df",gutterBackground:"#e1e2e7",gutterForeground:"#3760bf",gutterBorder:"transparent",lineHighlight:"#5f5faf11"},bt=[{tag:t.tags.keyword,color:"#007197"},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.macroName],color:"#3760bf"},{tag:[t.tags.propertyName],color:"#3760bf"},{tag:[t.tags.processingInstruction,t.tags.string,t.tags.inserted,t.tags.special(t.tags.string)],color:"#587539"},{tag:[t.tags.function(t.tags.variableName),t.tags.labelName],color:"#3760bf"},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:"#3760bf"},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:"#3760bf"},{tag:[t.tags.className],color:"#3760bf"},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:"#b15c00"},{tag:[t.tags.typeName],color:"#007197",fontStyle:"#007197"},{tag:[t.tags.operator,t.tags.operatorKeyword],color:"#007197"},{tag:[t.tags.url,t.tags.escape,t.tags.regexp,t.tags.link],color:"#587539"},{tag:[t.tags.meta,t.tags.comment],color:"#848cb5"},{tag:t.tags.strong,fontWeight:"bold"},{tag:t.tags.emphasis,fontStyle:"italic"},{tag:t.tags.link,textDecoration:"underline"},{tag:t.tags.heading,fontWeight:"bold",color:"#b15c00"},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:"#3760bf"},{tag:t.tags.invalid,color:"#f52a65"},{tag:t.tags.strikethrough,textDecoration:"line-through"}],yt=a=>{var{theme:s="light",settings:e={},styles:c=[]}={};return F({theme:s,settings:C({},pt,e),styles:[...bt,...c]})},vt=yt();gt({light:{extension:vt,colors:{subtleEmphasis:!0}},dark:{extension:kt,colors:{subtleEmphasis:!0}},options:{settingsKey:"extension.markeditThemeTokyoNight"}});
